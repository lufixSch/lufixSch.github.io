<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../../minimal_logo_dark_small.png" />
		<meta name="viewport" content="width=device-width" />
		
		<link href="../../_app/immutable/assets/0.84e8b692.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/article.70644360.css" rel="stylesheet">
		<link rel="modulepreload" href="../../_app/immutable/entry/start.8f217939.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/index.e23b10ae.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/singletons.f1c48379.js">
		<link rel="modulepreload" href="../../_app/immutable/entry/app.1cd0a4f9.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/preload-helper.41c905a7.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/0.1774b05e.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/stores.2e8af556.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/2.0cff86dc.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/11.0ed746e5.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/_page.12952414.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/article.e19d21fa.js"><title>Firefly III Import</title><!-- HEAD_svelte-1fi5dar_START --><meta property="og:title" content="Firefly III Import"><!-- HEAD_svelte-1fi5dar_END -->
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">


<nav class="z-20 bg-gray-100 dark:bg-gray-800 fixed top-0 left-0 w-full"><div class="flex justify-between items-center h-14"><div class="flex items-center"><a href="/" class="svelte-3njbym"><img src="/logo_dark_small.png" alt="logo" class="ml-4 w-12 h-12"></a></div>
		<ul class="hidden sm:flex flex-row"><li class="svelte-3njbym"><a href="/projects" class="svelte-3njbym active">Projects</a>
				</li><li class="svelte-3njbym"><a href="/resources" class="svelte-3njbym">Resources</a>
				</li><li class="svelte-3njbym"><a href="/updates" class="svelte-3njbym">Updates</a>
				</li></ul>
		<button class="flex sm:hidden hover:bg-primary dark:hover:bg-primary-dark hover:text-white" type="button"><svg class="fill-current p-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" height="3.5rem"><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"></path></svg></button></div>
	
</nav>
<div class="min-h-screen flex flex-col justify-between"><body class=""><div class="mt-20 mx-6 md:mx-12 lg:mx-24">

<section id="header" class="relative overflow-hidden flex justify-center md:justify-end items-end h-36"><img src="/articles/pcb_buttons.png" alt="Article related header" class="absolute w-full h-36 object-cover rounded-md">
	<a href="https://github.com/lufixSch/firefly-iii-import" title="View source (Project status: stalled)" class="z-10 bg-gray-50 dark:bg-gray-900 flex items-center m-2 p-2 w-fit rounded-md border-solid border-2 text-inherit dark:text-inherit hover:no-underline hover:text-inherit hover:dark:text-inherit space-x-1 hover:border-primary hover:dark:border-primary-dark fill-gray-900 dark:fill-gray-100 hover:fill-primary dark:hover:fill-primary-dark" target="_blank"><div id="icon" class="w-12 h-12 fill-inherit dark:fill-inherit"><svg xmlns="http://www.w3.org/2000/svg" height="1em" class="h-full" viewBox="0 0 448 512"><path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"></path></svg></div>
	<div><p>lufixSch/firefly-iii-import</p>
		<p class="m-0"><span>Status: <div class="h-[1.25rem] w-[1.25rem] inline-block align-middle mb-1"><svg viewBox="0 0 512 512" fill="none" class="h-full fill-orange-700 dark:fill-orange-500" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_201_26)"><path fill-rule="evenodd" clip-rule="evenodd" d="M256 512C397.385 512 512 397.385 512 256C512 114.615 397.385 0 256 0C114.615 0 0 114.615 0 256C0 397.385 114.615 512 256 512ZM164 232C150.745 232 140 242.745 140 256C140 269.255 150.745 280 164 280H348C361.255 280 372 269.255 372 256C372 242.745 361.255 232 348 232H164Z"></path></g><defs><clipPath id="clip0_201_26"><rect width="512" height="512" fill="white"></rect></clipPath></defs></svg></div></span></p></div></a></section>
<section id="content"><h1>Firefly III bank import</h1>
<p>Python programm/library for automatic import of transactions from different bankaccounts into Firefly III.</p>
<ul><li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#firefly-iii-bank-import" rel="nofollow">Firefly III bank import</a><ul><li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#supported-banks" rel="nofollow">Supported Banks</a><ul><li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#extend-bank-support" rel="nofollow">Extend Bank support</a></li></ul></li>
<li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#config" rel="nofollow">Config</a><ul><li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#firefly" rel="nofollow">Firefly</a></li>
<li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#banks" rel="nofollow">Banks</a><ul><li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#n26" rel="nofollow">N26</a></li></ul></li></ul></li>
<li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#cli" rel="nofollow">CLI</a></li>
<li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#python-module" rel="nofollow">Python Module</a><ul><li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#config-1" rel="nofollow">Config</a></li>
<li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#fireflyapi" rel="nofollow">FireflyAPI</a></li>
<li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#loader" rel="nofollow">Loader</a></li>
<li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#importer" rel="nofollow">Importer</a></li></ul></li>
<li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#known-issues" rel="nofollow">Known Issues</a><ul><li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#timezones" rel="nofollow">Timezones</a></li>
<li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#transactions-between-n26-spaces" rel="nofollow">Transactions between N26 spaces</a></li>
<li><a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#n26-transaction-limit" rel="nofollow">N26 Transaction limit</a></li></ul></li></ul></li></ul>
<h2>Supported Banks</h2>
<ul><li><a href="https://n26.com/de-de" rel="nofollow">N26</a><sup>*</sup></li></ul>
<blockquote><sup>*</sup> Realized using an inofficial API. Use with caution.
</blockquote>
<h3>Extend Bank support</h3>
<p>If you want to create support for a new bank account you need to create a new loader class as well as a new config class for this type of account (See <a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#python-module" rel="nofollow">Python Module</a> for a complete explanation of the class structure).</p>
<p>The config class should inherit from <code>config.BankConfig</code> and should contain the attributes necessary to configure access to this type of account. Make sure, to extend the <code>if-else</code> statement in <code>config.BankConfig.from_type()</code> as well as <code>config.BANK_TYPES</code> with the identifier of the new account type.</p>
<p>Next a new loader should be create which has to inherit from <code>loader.BaseLoader</code>. This is, where all the logic will be located. Write a method <code>load_transaction(start: datetime, end: datetime) which loads all transactions in the given timeframe and converts them into a </code>Transaction` object.</p>
<p>In the end make sure to also update the <code>if-else</code> statement in the <code>_init_loader</code> function of the <code>cli</code> module with the identifier of the new account type. Without this the new bank account will not work in the cli.</p>
<p><strong>Finished!</strong> You can now add the config of your bank account to the <code>f3i.config.toml</code> and you are ready to go.</p>
<h2>Config</h2>
<p>The Firefly importer uses a <code>.toml</code> file for configuration with the folowing structure. A minimal preset to get started with is also located in the root folder of this project.</p>
<h3>Firefly</h3>
<p>The firefly config includes the address of the firefly instance as well as a personal access token. The token has to be generated in Firefly III under <em>Options &gt; Profile &gt; OAuth</em>.</p>
<p><em>Example:</em></p>
<pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #ECEFF4">[</span><span style="color: #D8DEE9FF">firefly</span><span style="color: #ECEFF4">]</span></span>
<span class="line"><span style="color: #D8DEE9">host</span><span style="color: #ECEFF4">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">https://firefly/host/adress</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9">token</span><span style="color: #ECEFF4">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">private_access_token</span><span style="color: #ECEFF4">&quot;</span></span></code></pre>
<h3>Banks</h3>
<p>The banks config is a list of configurations for different accounts. Every account configuration needs at least a <code>type</code> and a <code>name</code>. Other values/options are defined by the given account type.</p>
<p>The <code>type</code> identifies which type of account this config is used for (see <a href="https://github.com/lufixSch/firefly-iii-import/blob/main/#supported-banks" rel="nofollow">Supported Banks</a>) and the <code>name</code> is the name of the equivalent account in Firefly III.</p>
<p><em>Example:</em></p>
<pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #ECEFF4">[[</span><span style="color: #D8DEE9FF">banks</span><span style="color: #ECEFF4">]]</span></span>
<span class="line"><span style="color: #D8DEE9">type</span><span style="color: #ECEFF4">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">n26</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9">name</span><span style="color: #ECEFF4">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">My Private Account</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9">...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ECEFF4">[[</span><span style="color: #D8DEE9FF">banks</span><span style="color: #ECEFF4">]]</span></span>
<span class="line"><span style="color: #D8DEE9">type</span><span style="color: #ECEFF4">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">n26</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9">name</span><span style="color: #ECEFF4">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">My Business Account</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9">...</span></span></code></pre>
<h4>N26</h4>
<p>The N26 account configuration takes the folowing values: <code>username</code>, <code>password</code>, <code>device_token</code>, <code>mfa_type</code> and <code>store_login_data</code></p>
<p>The <code>username</code> and <code>password</code> are the login informations to your N26 account. Be very carefull with this information</p>
<p>The <code>device_token</code> is a custom UUID which is used to identify your device. You can create it yourself using python:</p>
<pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #88C0D0">python</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">-c</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">&#39;</span><span style="color: #A3BE8C">import uuid; print(uuid.uuid4())</span><span style="color: #ECEFF4">&#39;</span></span></code></pre>
<p>With the <code>mfa_type</code> you decide with wich type of MFA the login of the program should be verified. You can choose between <strong>‘app’</strong> and <strong>‘sms’</strong>.</p>
<p>In order to avoid MFA every time the script is executed the login/token information can be saved on device. The option <code>store_login_data</code> decides if this is the case or not.</p>
<blockquote><p>The login information usually only remains valid for some minutes</p></blockquote>
<p><em>Example</em></p>
<pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #ECEFF4">[[</span><span style="color: #D8DEE9FF">banks</span><span style="color: #ECEFF4">]]</span></span>
<span class="line"><span style="color: #D8DEE9">type</span><span style="color: #ECEFF4">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">n26</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9">name</span><span style="color: #ECEFF4">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">My Private Account</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9">username</span><span style="color: #ECEFF4">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">some_email@domain.com</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9">password</span><span style="color: #ECEFF4">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">password</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9">device_token</span><span style="color: #ECEFF4">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">394d3be6-4fcf-452f-b089-a098b00c7457</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9">mfa_type</span><span style="color: #ECEFF4">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">app</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9">store_login_data</span><span style="color: #ECEFF4">=</span><span style="color: #81A1C1">true</span></span></code></pre>
<h2>CLI</h2>
<p>The CLI can be used to just import transactions from a given timeframe once or use the auto import to repeatedly import all transactions since the last time the script was executed.</p>
<p>The one time import can be executed by providing a <code>--from</code> and a optional <code>--to</code> date (and time) in <a href="https://en.wikipedia.org/wiki/ISO_8601" rel="nofollow">ISO 8601</a> format.</p>
<pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #88C0D0">f3i</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">--from</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">2022</span><span style="color: #A3BE8C">-03-10</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">--to</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">2022</span><span style="color: #A3BE8C">-04-10T10:30</span></span></code></pre>
<p>When no <code>--to</code> argument is provide the script automatically imports all transactions up to the current date.</p>
<pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #88C0D0">f3i</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">--from</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">2022</span><span style="color: #A3BE8C">-10-20</span></span></code></pre>
<p>When niether a <code>--from</code> and a <code>--to</code> date is provided the auto import is triggerd. This part of the script saves the last time it was executed and imports all transactions since this timestamp. The first time the auto import is executed no import will take place and it will just save the current date as the last execution time.</p>
<pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #88C0D0">f3i</span></span></code></pre>
<p>If you want to reset the last execution timestamp of the auto importer use the argument <code>--reset</code>.</p>
<pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #88C0D0">f3i</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">--reset</span></span></code></pre>
<p>By default the program looks for this file at <code>./</code> and then <code>~/</code>. Aditionally the path to a config file can be added when executing the cli using the <code>--config</code> option.</p>
<pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #88C0D0">f3i</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">--from</span><span style="color: #D8DEE9FF"> </span><span style="color: #B48EAD">2022</span><span style="color: #A3BE8C">-06-02</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">--config</span><span style="color: #D8DEE9FF"> </span><span style="color: #A3BE8C">./path/to/config.toml</span></span></code></pre>
<h2>Python Module</h2>
<p>Aside from the CLI the <code>firefly_iii_import</code> library can be used directly in a python program.</p>
<p>It provides an <code>FireflyAPI</code> abstraction layer for creating transactions and a set of loaders for different bank accounts. For easy import and configuration there is also the <code>Importer</code> class as well as some config classes.</p>
<h3>Config</h3>
<p>The <code>Config</code> class provides an easy and consistent way to interact with the <code>firefly_iii_import</code> configuration.
It can be used to load a config from a given path.</p>
<pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #81A1C1">from</span><span style="color: #D8DEE9FF"> firefly_iii_import </span><span style="color: #81A1C1">import</span><span style="color: #D8DEE9FF"> Config</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D8DEE9FF">Config</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">load</span><span style="color: #ECEFF4">(</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">path/to/config.toml</span><span style="color: #ECEFF4">&quot;</span><span style="color: #ECEFF4">)</span></span></code></pre>
<p>Alternatively the <code>Config</code> class can be initialized directly with a dictionary including the necessary information.</p>
<pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #81A1C1">from</span><span style="color: #D8DEE9FF"> firefly_iii_import </span><span style="color: #81A1C1">import</span><span style="color: #D8DEE9FF"> Config</span></span>
<span class="line"></span>
<span class="line"><span style="color: #88C0D0">Config</span><span style="color: #ECEFF4">(</span><span style="color: #88C0D0">dict</span><span style="color: #ECEFF4">(</span></span>
<span class="line"><span style="color: #D8DEE9FF">  </span><span style="color: #D8DEE9">firefly</span><span style="color: #81A1C1">=</span><span style="color: #88C0D0">dict</span><span style="color: #ECEFF4">(</span></span>
<span class="line"><span style="color: #D8DEE9FF">    </span><span style="color: #D8DEE9">host</span><span style="color: #81A1C1">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">https://firefly/host/adress</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9FF">    </span><span style="color: #D8DEE9">token</span><span style="color: #81A1C1">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">private_access_token</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9FF">  </span><span style="color: #ECEFF4">),</span></span>
<span class="line"><span style="color: #D8DEE9FF">  </span><span style="color: #D8DEE9">banks</span><span style="color: #81A1C1">=</span><span style="color: #ECEFF4">[</span></span>
<span class="line"><span style="color: #D8DEE9FF">    </span><span style="color: #88C0D0">dict</span><span style="color: #ECEFF4">(</span></span>
<span class="line"><span style="color: #D8DEE9FF">      </span><span style="color: #D8DEE9">type</span><span style="color: #81A1C1">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">n26</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9FF">      </span><span style="color: #D8DEE9">name</span><span style="color: #81A1C1">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">My Private Account</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9FF">      </span><span style="color: #D8DEE9">username</span><span style="color: #81A1C1">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">some_email@domain.com</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9FF">      </span><span style="color: #D8DEE9">password</span><span style="color: #81A1C1">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">password</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9FF">      </span><span style="color: #D8DEE9">device_token</span><span style="color: #81A1C1">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">394d3be6-4fcf-452f-b089-a098b00c7457</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9FF">      </span><span style="color: #D8DEE9">mfa_type</span><span style="color: #81A1C1">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">app</span><span style="color: #ECEFF4">&quot;</span></span>
<span class="line"><span style="color: #D8DEE9FF">      </span><span style="color: #D8DEE9">store_login_data</span><span style="color: #81A1C1">=True</span></span>
<span class="line"><span style="color: #D8DEE9FF">    </span><span style="color: #ECEFF4">)</span></span>
<span class="line"><span style="color: #D8DEE9FF">  </span><span style="color: #ECEFF4">]</span></span>
<span class="line"><span style="color: #ECEFF4">))</span></span></code></pre>
<p>The default path to the <em>f3i.config.toml</em> (if it was found) can be accessed using <code>DEFAULT_CONFIG_PATH</code>. If no file was found this variable is a empty string.</p>
<pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #81A1C1">from</span><span style="color: #D8DEE9FF"> firefly_iii_import </span><span style="color: #81A1C1">import</span><span style="color: #D8DEE9FF"> DEFAULT_CONFIG_PATH</span></span></code></pre>
<h3>FireflyAPI</h3>
<p>The <code>FireflyAPI</code> class is a minimal abstraction layer for the Firefly III Api based on the <a href="https://github.com/ms32035/firefly-iii-client" rel="nofollow"><code>firefly_iii_client</code></a> library. It only provides a method to create a single <code>Transaction</code>.</p>
<pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #81A1C1">from</span><span style="color: #D8DEE9FF"> firefly_iii_import </span><span style="color: #81A1C1">import</span><span style="color: #D8DEE9FF"> FireflyAPI</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> Transaction</span></span>
<span class="line"><span style="color: #81A1C1">from</span><span style="color: #D8DEE9FF"> firefly_iii_client</span><span style="color: #ECEFF4">.</span><span style="color: #D8DEE9FF">model</span><span style="color: #ECEFF4">.</span><span style="color: #D8DEE9FF">transaction_type_property </span><span style="color: #81A1C1">import</span><span style="color: #D8DEE9FF"> TransactionTypeProperty</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D8DEE9FF">api </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #88C0D0">FireflyAPI</span><span style="color: #ECEFF4">(</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">https://firefly/host/adress</span><span style="color: #ECEFF4">&quot;</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> </span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">personal_access_token</span><span style="color: #ECEFF4">&quot;</span><span style="color: #ECEFF4">)</span></span>
<span class="line"><span style="color: #D8DEE9FF">api</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">create_transaction</span><span style="color: #ECEFF4">(</span></span>
<span class="line"><span style="color: #D8DEE9FF">  </span><span style="color: #88C0D0">Transaction</span><span style="color: #ECEFF4">(</span></span>
<span class="line"><span style="color: #D8DEE9FF">    </span><span style="color: #D8DEE9">amount</span><span style="color: #81A1C1">=</span><span style="color: #B48EAD">3</span><span style="color: #ECEFF4">,</span></span>
<span class="line"><span style="color: #D8DEE9FF">    </span><span style="color: #D8DEE9">source</span><span style="color: #81A1C1">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">My Account</span><span style="color: #ECEFF4">&quot;</span><span style="color: #ECEFF4">,</span></span>
<span class="line"><span style="color: #D8DEE9FF">    </span><span style="color: #D8DEE9">destination</span><span style="color: #81A1C1">=</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">Partner Account</span><span style="color: #ECEFF4">&quot;</span><span style="color: #ECEFF4">,</span></span>
<span class="line"><span style="color: #D8DEE9FF">    </span><span style="color: #D8DEE9">date</span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF">datetime</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">now</span><span style="color: #ECEFF4">(),</span></span>
<span class="line"><span style="color: #D8DEE9FF">    </span><span style="color: #D8DEE9">type</span><span style="color: #81A1C1">=</span><span style="color: #88C0D0">TransactionTypeProperty</span><span style="color: #ECEFF4">(</span><span style="color: #ECEFF4">&quot;</span><span style="color: #A3BE8C">withdrawal</span><span style="color: #ECEFF4">&quot;</span><span style="color: #ECEFF4">)</span></span>
<span class="line"><span style="color: #D8DEE9FF">  </span><span style="color: #ECEFF4">)</span></span>
<span class="line"><span style="color: #ECEFF4">)</span></span></code></pre>
<h3>Loader</h3>
<p>The <code>loader</code> module contains the different loading logic for all bank accounts. Each supported bank has it’s own loader class based on <code>loader.BaseLoader</code>. Therefore they all provide a <code>load_transaction(start, end)</code> method. This method loads all transactions in the given timeframe and returns them as <code>list</code> of <code>Transaction</code> objects.</p>
<pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #81A1C1">from</span><span style="color: #D8DEE9FF"> firefly_iii_import</span><span style="color: #ECEFF4">.</span><span style="color: #D8DEE9FF">loader </span><span style="color: #81A1C1">import</span><span style="color: #D8DEE9FF"> N26Loader</span></span>
<span class="line"><span style="color: #81A1C1">from</span><span style="color: #D8DEE9FF"> firefly_iii_import </span><span style="color: #81A1C1">import</span><span style="color: #D8DEE9FF"> Transaction</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D8DEE9FF">loader </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #88C0D0">N26Loader</span><span style="color: #ECEFF4">(</span><span style="color: #D8DEE9FF">n26_account_config</span><span style="color: #ECEFF4">)</span></span>
<span class="line"><span style="color: #D8DEE9FF">transactions</span><span style="color: #ECEFF4">:</span><span style="color: #D8DEE9FF"> List</span><span style="color: #ECEFF4">[</span><span style="color: #D8DEE9FF">Transation</span><span style="color: #ECEFF4">]</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> loader</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">load_transactions</span><span style="color: #ECEFF4">(</span><span style="color: #D8DEE9FF">datetime</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">now</span><span style="color: #ECEFF4">()</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">-</span><span style="color: #D8DEE9FF"> </span><span style="color: #88C0D0">timedelta</span><span style="color: #ECEFF4">(</span><span style="color: #D8DEE9">days</span><span style="color: #81A1C1">=</span><span style="color: #B48EAD">5</span><span style="color: #ECEFF4">),</span><span style="color: #D8DEE9FF"> datetime</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">now</span><span style="color: #ECEFF4">())</span></span></code></pre>
<h3>Importer</h3>
<p>The <code>Importer</code> class provides a general interface to import transactions from different accounts into Firefly III. It provides a method for automatic import (<code>auto_import()</code>) as well as for import in a given timeframe (<code>run(start, end)</code>). The class also provides a method to reset the ‘last_executed’ timestamp for the auto import (<code>reset_auto_import</code>)</p>
<p>On initialization you ned to provide a list of <code>loader.BaseLoader</code> objects which are later used to load the transactions.</p>
<pre class="shiki nord" style="background-color: #2e3440ff" tabindex="0"><code><span class="line"><span style="color: #81A1C1">from</span><span style="color: #D8DEE9FF"> firefly_iii_import </span><span style="color: #81A1C1">import</span><span style="color: #D8DEE9FF"> Importer</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D8DEE9FF">importer </span><span style="color: #81A1C1">=</span><span style="color: #D8DEE9FF"> </span><span style="color: #88C0D0">Importer</span><span style="color: #ECEFF4">(</span><span style="color: #D8DEE9FF">loaders</span><span style="color: #ECEFF4">,</span><span style="color: #D8DEE9FF"> firefly_api</span><span style="color: #ECEFF4">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #D8DEE9FF">importer</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">run</span><span style="color: #ECEFF4">(</span><span style="color: #D8DEE9FF">datetime</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">now</span><span style="color: #ECEFF4">()</span><span style="color: #D8DEE9FF"> </span><span style="color: #81A1C1">-</span><span style="color: #D8DEE9FF"> </span><span style="color: #88C0D0">timedelta</span><span style="color: #ECEFF4">(</span><span style="color: #D8DEE9">days</span><span style="color: #81A1C1">=</span><span style="color: #B48EAD">5</span><span style="color: #ECEFF4">),</span><span style="color: #D8DEE9FF"> datetime</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">now</span><span style="color: #ECEFF4">())</span></span>
<span class="line"><span style="color: #D8DEE9FF">importer</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">auto_import</span><span style="color: #ECEFF4">()</span></span>
<span class="line"><span style="color: #D8DEE9FF">importer</span><span style="color: #ECEFF4">.</span><span style="color: #88C0D0">reset</span><span style="color: #ECEFF4">()</span></span></code></pre>
<h2>Known Issues</h2>
<h3>Timezones</h3>
<p>At the moment there is no handling of timezones when loading and creating transactions. This could cause some shifts in date and time during the import process. If you execute the script in the same timezone as your Firefly III instance is running and your bank accounts are registered there should be no problem</p>
<blockquote><p>N26 only provides a timestamp with the transaction but no timezone. From my limited testing the timestamp seems to be in the same timezone as the ‘location’ of the account.</p></blockquote>
<h3>Transactions between N26 spaces</h3>
<p>Transaction between N26 spaces are not handled in this importer. In general the N26 API only provides transactions between the main space and other spaces. Those usually occur in Firefly III with a source or destination called something like <strong>‘From Space A to Space B’</strong> in the category <strong>‘Scellaneous’</strong>.</p>
<p>The easiest workaround is to use Firefly III rules to change or delete those transactions.</p>
<h3>N26 Transaction limit</h3>
<p>When loading transactions from a N26 account the API requires to limit the number of transactions to load. In the <code>N26Loader</code> this limit is set to <code>10000</code> which should be enough for most imports but you should be aware of this limit.</p></section></div></body>
	<footer class="flex flex-col md:flex-row justify-evenly p-4 pt-6 border-t-[1px] border-gray-100 dark:border-gray-600"><p class="svelte-opo63t">Many of the articles on this website are automatically generated from the markdown files in the
		corresponding repositories. This might lead to some unexpected results, so please let me know if
		you find any errors!
	</p>
	<p class="svelte-opo63t">Some articles are still in German, but I am working on translating them. If you are interested
		in a specific article, don&#39;t hesitate to contact me!
	</p>
	<p class="svelte-opo63t">If you want to get in touch, you can send me an email at <a href="mailto:lukas.schuettler@tum.de">lukas.schuettler@tum.de</a>.
	</p>
</footer></div>


			
			<script>
				{
					__sveltekit_106m5y1 = {
						base: new URL("../..", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [null,null,null];

					Promise.all([
						import("../../_app/immutable/entry/start.8f217939.js"),
						import("../../_app/immutable/entry/app.1cd0a4f9.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 2, 11],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
