#!/usr/bin/env python3

"""
Move homepage content from `build` to the publishing directory
Then push update to git
"""

import os
import shutil

PUBLISH_DIR = "docs"


def move_content():
    """Clear the publishing directory and move content from `build`
    (create publishing directory if it doesn't exist)
    """

    print("> Moving page content")

    if os.path.exists(PUBLISH_DIR):
        shutil.rmtree(PUBLISH_DIR)

    shutil.copytree("build", PUBLISH_DIR)

    # Create .nojekyll file to prevent GitHub from trying to build the site
    with open(f"{PUBLISH_DIR}/.nojekyll", "w") as f:
        f.write("")


def push_to_git():
    """Push changes to git with useful commit message"""

    print("> Pushing to git")

    os.system(f"git add {PUBLISH_DIR}")
    os.system("git commit -m 'Publish site'")
    os.system("git push")


if __name__ == "__main__":
    move_content()
    push_to_git()
